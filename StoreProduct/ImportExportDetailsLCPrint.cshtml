


@**************************** Created By Jerin Jahan (Date:06-06-2017)  *****************************************@
@using FactoryManagement.Helpers
@model FactoryManagement.Models.View_Import_History_Details
@{
    ViewBag.Title = "Print Import History";
    Layout = "~/Views/Shared/_Layout.cshtml";
    FactoryManagement.Models.FactoryManagementEntities db = new FactoryManagement.Models.FactoryManagementEntities();
    var Fact_Info = db.FactoryInformations.FirstOrDefault();
    var importLocation = db.View_Import_Item_Details.Where(m => m.ImportId == Model.ImportId || m.ParentId == Model.ImportId).ToList();
    var count = 0;

    var importItems = db.View_Import_Item_Details.Where(m => m.ImportId == Model.ImportId || m.ParentId == Model.ImportId).OrderByDescending(m => m.InsertedDate).ToList();
    var disItems = db.View_Dispacth_Item_Details.Where(m => m.ImportId == Model.ImportId).OrderByDescending(m => m.DispatchedDate).ToList();

    double totalImp = importItems.Sum(m => m.Quantity);
    double totaldis = disItems.Sum(m => m.Quantity);
    
    int serial = 0;
    int serial2 = 0;
}

<section class="content-header" style="text-align:center;">
    <h3>Import Item Details</h3>
    <p>@Fact_Info.Name</p>
    <p>Fax : @Fact_Info.Fax</p>
    <p>Email : @Fact_Info.Email</p>
</section>
<div class="row">
    <div class="col-xs-offset-6 col-xs-6 text-right">
        <h1><small>@Model.TransactionName</small></h1>
        <p>
            L/C:@Model.L_C<br>
            Product Name : @Model.ProductName<br>
            Total Quantity : @Model.Quantity @Model.UnitName <br>
            Imported Date : @Model.InsertedDateFormat <br>
            Imported By : <img class="img-circle" src="/Images/UserPicture/thumb/@Model.InsertedUserPic"> @Model.InsertedByUserName<br>
            Generated By :@Request.Cookies["CookieAdminInfo"].Values["username"].ToString()<br />
            Generated Date :@DateTime.Now.ToString("MMM dd, yyyy hh:mm tt")
        </p>
    </div>
</div>

<h4>Import Item Lists</h4><hr />
@if (importItems.Count() > 0)
{
    <table class="table table-bordered" style="margin-bottom:30px!important;border:2px solid black;">
        <tr>
            <th width="5%">#</th>
            <th width="10%">Quantity</th>
            <th width="20%">Voucher Name</th>
            <th width="20%">Assigned Location</th>
            <th width="20%">Imported Date</th>
            <th width="25%">Imported By</th>
        </tr>
        @foreach (var data in importItems)
        {
            serial++;
            <tr>
                <td>@serial .</td>
                <td>@data.Quantity @Model.UnitName </td>
                <td>@data.TransactionName</td>
                <td>@data.AssignLocation</td>
                <td>@data.InsertedDateFormat</td>
                <td>@data.InsertedByUserName</td>
            </tr>
        }  
    </table>
    <table class="table" style="margin-top:-30px!important;border:none!important;">
        <tr style="border:none!important;">
            <th style="text-align:right;">Total Quantity : @totalImp @Model.UnitName</th>
        </tr>
    </table>
}
else
{
    <p>No item imported....</p>
}

<h4>Dispatch Item Lists</h4><hr />
@if (disItems.Count() > 0)
{
    <table class="table table-bordered" style="margin-bottom:30px!important;border:2px solid black;">
        <tr>
            <th width="5%">#</th>
            <th width="10%">Quantity</th>
            <th width="20%">Voucher Name</th>
            <th width="20%">Dispatched With</th>
            <th width="20%">Dispatched Date</th>
            <th width="25%">Dispatched By</th>
        </tr>
        @foreach (var data in disItems)
        {
            serial2++;
            <tr>
                <td>@serial2 .</td>
                <td>@data.Quantity @Model.UnitName </td>
                <td>@data.VoucherName</td>
                <td>
                    @if (data.MachineId > 0)
                    {
                        <span>@data.MachineName</span>
                    }
                    else
                    {
                        <span>@data.DeptName_Unit</span>
                    }
                </td>
                <td>@data.DispatchedDateName</td>
                <td>@data.DispatchedUserName</td>
            </tr>
        }
    </table>
    <table class="table" style="margin-top:-30px!important;border:none!important;">
        <tr style="border:none!important;">
            <th style="text-align:right;">Total Quantity : @totaldis @Model.UnitName</th>
        </tr>
    </table>
}
else
{
    <p>No item dispatch....</p>
}